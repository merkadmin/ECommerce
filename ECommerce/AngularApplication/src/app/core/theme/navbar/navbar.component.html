<nav class="navbar" (clickOutside)="closeAllMenus()">
  <div class="navbar-container">
    <!-- Logo -->
    <a class="navbar-logo" routerLink="/dashboard">
      <span class="logo-text">Price<span class="logo-accent">Compare</span></span>
    </a>

    <!-- Search Bar -->
    <div class="navbar-search">
      <div class="search-input-container">
        <i class="icon-search"></i>
        <input
          type="text"
          class="search-input"
          placeholder="Search products, brands, categories..."
          [(ngModel)]="searchQuery"
          (keyup.enter)="onSearch()"
        />
        <button class="search-btn" (click)="onSearch()" *ngIf="searchQuery">
          Search
        </button>
      </div>
    </div>

    <!-- Nav Actions -->
    <div class="navbar-actions">
      <!-- Wishlist -->
      <a class="nav-action" routerLink="/wishlist" title="Wishlist">
        <i class="icon-heart"></i>
        <span class="badge" *ngIf="wishlistCount > 0">{{ wishlistCount }}</span>
      </a>

      <!-- Cart -->
      <a class="nav-action" routerLink="/cart" title="Cart">
        <i class="icon-cart"></i>
        <span class="badge" *ngIf="cartCount > 0">{{ cartCount }}</span>
      </a>

      <!-- Price Alerts -->
      <a class="nav-action" routerLink="/alerts" title="Price Alerts" *ngIf="isAuthenticated">
        <i class="icon-bell"></i>
        <span class="badge" *ngIf="alertCount > 0">{{ alertCount }}</span>
      </a>

      <!-- Language Selector -->
      <div class="nav-dropdown">
        <button class="nav-action" (click)="toggleLangMenu()" title="Language">
          <i class="icon-globe"></i>
          <span class="lang-code">{{ activeLang.code.toUpperCase() }}</span>
        </button>

        <div class="dropdown-menu lang-menu" *ngIf="showLangMenu">
          <button
            *ngFor="let lang of languages"
            class="dropdown-item"
            [class.active]="lang.code === activeLang.code"
            (click)="changeLanguage(lang.code)">
            <span class="lang-name">{{ lang.name }}</span>
          </button>
        </div>
      </div>

      <!-- User Menu (Authenticated) -->
      <div class="nav-dropdown" *ngIf="isAuthenticated">
        <button class="nav-action user-action" (click)="toggleUserMenu()">
          <div class="user-avatar">
            <img [src]="currentUser?.avatarUrl || 'assets/images/default-avatar.png'" [alt]="currentUser?.firstName" />
          </div>
          <span class="user-name d-none d-md-inline">{{ currentUser?.firstName }}</span>
          <i class="icon-chevron-down"></i>
        </button>

        <div class="dropdown-menu user-menu" *ngIf="showUserMenu">
          <div class="dropdown-header">
            <span class="user-email">{{ currentUser?.email }}</span>
          </div>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" routerLink="/profile" (click)="closeAllMenus()">
            <i class="icon-user"></i>
            My Profile
          </a>
          <a class="dropdown-item" routerLink="/alerts" (click)="closeAllMenus()">
            <i class="icon-bell"></i>
            Price Alerts
          </a>
          <a class="dropdown-item" routerLink="/wishlist" (click)="closeAllMenus()">
            <i class="icon-heart"></i>
            Wishlist
          </a>
          <div class="dropdown-divider"></div>
          <button class="dropdown-item text-danger" (click)="logout()">
            <i class="icon-logout"></i>
            Logout
          </button>
        </div>
      </div>

      <!-- Login/Register (Guest) -->
      <div class="auth-buttons" *ngIf="!isAuthenticated">
        <a class="btn btn-outline" routerLink="/login">Login</a>
        <a class="btn btn-primary" routerLink="/register">Register</a>
      </div>
    </div>
  </div>
</nav>
